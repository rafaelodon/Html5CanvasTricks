<html>
	<head>
		<script type="text/javascript" src="jquery-1.6.2.min.js"></script>
	</head>
	<body>
		<canvas id="myCanvas" width="1200" height="400" style="border: 1px solid black">
		</canvas>
		<div id="output"></div>
		need to find a way to handle subsequent clicks on the canvas..
		<script type="text/javascript">

			$(document).ready(function (){

				var canvas = document.getElementById("myCanvas");
				var context = canvas.getContext("2d");

				var x0=500;
				var y0=250;

				var x=x0;
				var y=y0;

				var xl;
				var yl;

				var t=0;	
				var tf=31;
				var tf2=parseInt(tf/2);
				var v0x=0;
				var v0y=0;
				var vfx, vfy, ax, ay;
				var vx=0;
				var vy=0;

				var move=false;

				function startMovement(mx, my){

					x0 = x;
					y0 = y;

					xl = mx;
					yl = my;

					v0x=0;
					v0y=0;

					vx = v0x;
					vy = v0y;

					t = 0;

					var xl2=parseInt(x0+(xl-x0)/2);
					var yl2=parseInt(y0+(yl-y0)/2);
					var dx = xl2-x0;
					var dy = yl2-y0;

					vfx=(2*dx-v0x*tf2)/tf2;
					vfy=(2*dy-v0y*tf2)/tf2;

					ax=(vfx-v0x)/(tf2);
					ay=(vfy-v0y)/(tf2);

					move = true;
				}

				$('#myCanvas').mousedown(function (e){
					mx = e.pageX - this.offsetLeft;
					my = e.pageY - this.offsetTop;

					startMovement(mx,my);
				});

				function refresh(){

					context.clearRect(0,0,1200,400);
					if(move){
						t++;
						if(t<=tf2){
								
							x = x0 + v0x*t + (ax*t*t)/2;
							y = y0 + v0y*t + (ay*t*t)/2;

							vx = v0x + ax*t;
							vy = v0y + ay*t;

							if(t==tf2 && vx == 0 && vy == 0){
								move=false;
							}
						}else{
							t = 0;
							x0 = x;
							y0 = y;
							v0x = vx;
							v0y = vy;
							ax=(0-v0x)/(tf2);
							ay=(0-v0y)/(tf2);
						}
					}

					var text = document.getElementById("output");
					text.innerHTML = "x,y="+parseInt(x)+","+parseInt(y)+"<br/>t="+t+"<br/>vx="+vx+"<br/>xy="+vy;
									
					context.fillStyle = "#AA0000";
					context.beginPath();
					context.arc(x,y,20,0,Math.PI*180,false);
					context.closePath();
					context.fill();

					context.restore();

					context.width = context.width;
				}

				var t = setInterval(function (){
						refresh();
						},33);
			});
		</script>
	</body>
</html>
